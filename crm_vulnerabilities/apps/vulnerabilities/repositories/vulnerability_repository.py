from apps.vulnerabilities.interfaces import IVulnerabilityRepository
from apps.vulnerabilities.models import Vulnerability


class VulnerabilityRepository(IVulnerabilityRepository):
    def __init__(self) -> None:
        self.model = Vulnerability

    def get_fixed_vulnerabilities(self):
        """Obtiene todas las vulnerabilidades fixeadas de la base de datos"""
        all_fixed_vulnerabilities = self.model.objects.all()

        return all_fixed_vulnerabilities

    def add_to_fixed_vulnerabilities(self, vulnerability):
        """Agrega una vulnerabilidad fixeada a la base de datos"""
        vulnerability = self.model.objects.create(
            id=vulnerability["id"],
            description=vulnerability["description"],
            severity=vulnerability["severity"],
        )

        return vulnerability
