from rest_framework import serializers


class VulnerabilitySummarySerializer(serializers.Serializer):
    """Serializer para resumir vulnerabilidades por severidad"""

    severity = serializers.CharField()
    count = serializers.IntegerField()

    def validate_severity(self, value):
        """Validación para asegurarse que la severidad tiene un valor correcto"""
        valid_severities = ["LOW", "MEDIUM", "HIGH", "CRITICAL"]
        if value.upper() not in valid_severities:
            raise serializers.ValidationError(
                "La severidad proporcionada no es válida."
            )
        return value.upper()
