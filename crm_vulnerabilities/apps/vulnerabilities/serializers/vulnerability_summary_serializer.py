from rest_framework import serializers


class VulnerabilitySummarySerializer(serializers.Serializer):
    """
    Serializer to summarize vulnerabilities by severity.
    """

    severity = serializers.CharField()
    count = serializers.IntegerField()

    def validate_severity(self, value):
        """
        Validate to ensure that the severity has a correct value.

        Args:
            value (str): The severity level to validate.

        Returns:
            str: The validated severity level.

        Raises:
            serializers.ValidationError: If the severity is not valid.
        """
        valid_severities = ["LOW", "MEDIUM", "HIGH", "CRITICAL", "NOT SPECIFIED"]
        if value.upper() not in valid_severities:
            raise serializers.ValidationError("The provided severity is not valid.")
        return value.upper()
