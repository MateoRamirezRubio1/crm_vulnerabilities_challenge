class VulnerabilityAggregator:
    def summarize_by_severity(self, vulnerabilities):
        """Agrupa las vulnerabilidades por severidad"""
        summary = dict()

        for vulnerability in vulnerabilities:
            severity = vulnerability["cve"]["metrics"]["cvssMetricV2"][0][
                "baseSeverity"
            ]
            if severity not in summary:
                summary[severity] = 0
            summary[severity] += 1

        return [{"severity": k, "count": v} for k, v in summary.items()]
