class VulnerabilityAggregator:
    def summarize_by_severity(self, vulnerabilities):
        """Agrupa las vulnerabilidades por severidad"""
        summary = dict()

        for vulnerability in vulnerabilities:
            severity = str(
                vulnerability.get("cve", {})
                .get("metrics", {})
                .get("cvssMetricV2", [{}])[0]
                .get("baseSeverity", "")
            )
            if not severity:
                severity = "Not specified"
            if severity not in summary:
                summary[severity] = 0
            summary[severity] += 1

        return [{"severity": k, "count": v} for k, v in summary.items()]
